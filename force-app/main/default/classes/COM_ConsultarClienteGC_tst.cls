@isTest
private class COM_ConsultarClienteGC_tst {
	
	private static COM_ConsultarClienteGC_ws clsConsultar = new COM_ConsultarClienteGC_ws();
	private static String responseEmpresa = '{"CustomerMng_ConsultaCliente_Response":{"Header":{"RequestDate":"2017-08-31T12:01:23.542-05:00","ResponseDate":"2017-08-31T12:01:23.839-05:00","ResponseCode":"0","ResponseDesc":"OK","TransactionID":"99999912345"},"Body":{"Vinculacion":{"AfiliadoCaja":"true","AfiliacionConResponsable":"false","AfiliadoSalud":"false","AfiliadoPLC":"false"},"Cliente":{"TipoIdentificacion":"2","NumeroIdentificacion":"900017447","Id":"9999803423465130","datosEmpresa":{"digitoVerificadorLegal":"8","razonSocial":"FALABELLADECOLOMBIASA","nombreComercial":"-","estadoAfiliacion":"A","motivoInactivacion":{"id":"0"}},"datosRepresentanteLegal":{"TipoIdentificacion":"4","NumeroIdentificacion":"378379","Id":"6235005558768761","nombrePrimero":"RODRIGO","nombreSegundo":"","apellidoPrimero":"FAJARDO","apellidoSegundo":"ZILLERUELO","nombre":"RODRIGOFAJARDOZILLERUELO","foneticoID":"19701028FAJARDOSIRODRIJO","nuip":"","demografia":{"nacimientoFecha":"1970-10-28T00:00:00","genero":"M","estadoCivil":"CA","TitulosObtenidos":"","OficiosProfesiones":"","OtrosEstudios":""}},"Sucursal":{"sucursal":[{"id": "12345678901","sucursalID": "4","centroCostosID": "0","nivelAdicional": "S","razonSocial": "sucursal","mantenimiento": "A"},{"id": "12345678902","sucursalID": "4","centroCostosID": "1","nivelAdicional": "N","razonSocial": "centro de costo","mantenimiento": "A"}]},"comunicacionesCliente":{"comunicacionCliente":[{"telefonos":{"telefonoComunicacion":[{"tipoTelefono":"1","telefono":"7420404","extensionTelefono":"0"},{"tipoTelefono":"2","telefono":"-1"}]},"domicilios":{"domicilioComunicacion":[{"barrio":"CHICONORTEII","tipoDomicilio":"","domicilio":"CL99#11A-32PI2","codigoPostal":"-","localidad":{"id":"11001","municipio":{"id":"-1","departamento":{"id":"-"}},"nombre":"BOGOTAD.C."},"tipoAreaGeografica":"U"}]},"correosElectronicos":{"correoElectronico":["CGUERRA7X@XFALABELLA0.COM0.CO","CGUERRA8X@XFALABELLA0.COM0.CO"]},"celulares":{"celular":["7005679457"]},"redesSociales":"","opTinEmail":"true","opTinSMS":"true","adicionalesContacto":{"borradoEstado":"A","creacionFecha":"2017-02-22T00:00:00","ultimaNovedadFecha":"2017-02-22T00:00:00","identificador":"980713","orden":"1","zonaBogota":"2"}}]},"Contacto":"","Afiliacion":{"afiliacion":[{"cantidadVinculacion":"1","categoriaAfiliacion":"K","motivoRetiro":{"id":"0","nombre":"-"},"ClienteResponsable":{"clienteResponsable":[{"tipoResponsable":"1","id":"0","legalID":"0","tipoIdentificacion":"0"},{"tipoResponsable":"2","id":"0","legalID":"0","tipoIdentificacion":"0"},{"tipoResponsable":"3","id":"0","legalID":"0","tipoIdentificacion":"0"},{"tipoResponsable":"4","id":"0","legalID":"0","tipoIdentificacion":"0"}]},"cmnt":"A","actualizadoEstado":"false","nuevoEstado":"false","estado":"0","ingresoEmpresaFecha":"2006-03-15T00:00:00","inicioFecha":"2005-11-25T00:00:00","soloServicio":"0","valorVinculacion":"0","variableRetiro":"CRETEMP","Programa":{"programa":[{"condicion":"1","diasPaHisto":"0","tipoRadicacion":"0","edadReAuto":"0","genNuevoRadicadoEstado":"false","grupo":"0","id":"1011","programaPadre":"-1","indicadorProgramaEstado":"0","indicadorVinculacionEstado":"0","manejaResponsable1PersonaEstado":"false","manejaResponsable2EmpresaEstado":"false","motivoRetiroOpcional":{"id":"0","nombre":"-"},"clientePropietarioID":"0","tipoParentesco":"AC","sigla":"CJ","tipoIdClientePropietario":"0","nombrePrograma":"EmpresasAfiliadasCaja","diasParaReactivacion":"0"}]},"id":"2807352","motivoInactivacion":{"id":"0"},"estadoAfiliacion":"0"}]},"Radicacion":""},"atributosComunes":{"comunEntrePE":"false"}}}}';
	private static String responsePersona = '{"CustomerMng_ConsultaCliente_Response":{"Header":{"RequestDate":"2017-08-31T16:14:37.564-05:00","ResponseDate":"2017-08-31T16:14:37.9-05:00","ResponseCode":"0","ResponseDesc":"OK","TransactionID":"99999912345"},"Body":{"Vinculacion":{"AfiliadoCaja":"false","AfiliacionConResponsable":"false","AfiliadoSalud":"false","AfiliadoPLC":"false"},"Cliente":{"TipoIdentificacion":"1","NumeroIdentificacion":"1","Id":"9999803423702961","datosPersona":{"nombrePrimero":"JESUS","nombreSegundo":"","apellidoPrimero":"OVIEDO","apellidoSegundo":"","nombre":"JESUSOVIEDO","foneticoID":"19480615OVIEDOJESUS","nuip":"","Familia":"","demografia":{"nacimientoFecha":"1948-06-15T00:00:00","nacimientoLugar":"","genero":"M","estadoCivil":"SO","gradoEscolaridad":"","TitulosObtenidos":"","OficiosProfesiones":"","OtrosEstudios":""},"categoriaAfiliacion":"","estadoAfiliacion":"D","motivoInactivacion":{"id":"21"}},"Sucursal":{"sucursal":[{"id":"","sucursalID":"0","nivelAdicional":"D","razonSocial":"","mantenimiento":""}]},"comunicacionesCliente":{"comunicacionCliente":[{"telefonos":{"telefonoComunicacion":[{"tipoTelefono":"1","telefono":"3560170","extensionTelefono":"0"}]},"domicilios":{"domicilioComunicacion":[{"barrio":".","tipoDomicilio":"","domicilio":"CALLE34#7ESTE99BL20CS14","codigoPostal":"-","localidad":{"id":"11001","municipio":{"id":"-1","nombre":"","departamento":{"id":"-"}},"nombre":"BOGOTAD.C."},"tipoAreaGeografica":"U"}]},"correosElectronicos":{"correoElectronico":["NACESARITO3X@XYAHOO1.COM"]},"celulares":{"celular":["7104836645"]},"redesSociales":"","opTinEmail":"true","opTinSMS":"true","adicionalesContacto":{"borradoEstado":"A","identificador":"1006010","orden":"1","zonaBogota":"0"}}]},"Contacto":"","Afiliacion":{"afiliacion":[{"beneficiarios":"","cantidadVinculacion":"0","categoriaAfiliacion":"","motivoRetiro":{"id":"1","nombre":"-"},"ClienteResponsable":{"clienteResponsable":[{"tipoResponsable":"1","id":"9999803431968415","nombre":"MARIADEJESUSRAMOSALDANA","legalID":"39714350","tipoIdentificacion":"1"},{"tipoResponsable":"2","id":"0","nombre":"","legalID":"0","tipoIdentificacion":"0"},{"tipoResponsable":"3","id":"0","nombre":"","legalID":"0","tipoIdentificacion":"0"},{"tipoResponsable":"4","id":"0","nombre":"","legalID":"0","tipoIdentificacion":"0"}]},"cmnt":"H","actualizadoEstado":"false","nuevoEstado":"false","estado":"1","finFecha":"2000-11-30T00:00:00","ingresoEmpresaFecha":"1998-10-16T00:00:00","inicioFecha":"1998-10-16T00:00:00","retiroFecha":"2000-11-30T00:00:00","soloServicio":"0","textoVinculacion":"","valorVinculacion":"0","variableRetiro":"CRETHIJ","Programa":{"programa":[{"condicion":"3","diasPaHisto":"0","tipoRadicacion":"0","edadReAuto":"0","genNuevoRadicadoEstado":"false","grupo":"0","id":"10321","programaPadre":"1021","indicadorProgramaEstado":"0","indicadorVinculacionEstado":"0","manejaResponsable1PersonaEstado":"false","manejaResponsable2EmpresaEstado":"false","motivoRetiroOpcional":{"id":"1","nombre":"VoluntarioportrasladodeCaja"},"clientePropietarioID":"0","tipoParentesco":"HI","sigla":"CJ","tipoIdClientePropietario":"0","nombrePrograma":"HijosdeTrabajadorDependiente","nombreProgramaPadre":"","diasParaReactivacion":"0"}]},"id":"2811432","motivoInactivacion":{"id":"21"},"estadoAfiliacion":"1","clienteID":""},{"beneficiarios":"","cantidadVinculacion":"0","categoriaAfiliacion":"","motivoRetiro":{"id":"1","nombre":"-"},"ClienteResponsable":{"clienteResponsable":[{"tipoResponsable":"1","id":"9999803465819992","nombre":"BLANCALEONORZAMUDIO","legalID":"41543226","tipoIdentificacion":"1"},{"tipoResponsable":"2","id":"0","nombre":"","legalID":"0","tipoIdentificacion":"0"},{"tipoResponsable":"3","id":"0","nombre":"","legalID":"0","tipoIdentificacion":"0"},{"tipoResponsable":"4","id":"0","nombre":"","legalID":"0","tipoIdentificacion":"0"}]},"cmnt":"H","actualizadoEstado":"false","nuevoEstado":"false","estado":"1","finFecha":"2001-05-01T00:00:00","ingresoEmpresaFecha":"2000-05-10T00:00:00","inicioFecha":"2000-05-10T00:00:00","retiroFecha":"2001-05-01T00:00:00","soloServicio":"0","textoVinculacion":"","valorVinculacion":"0","variableRetiro":"CRETHIJ","Programa":{"programa":[{"condicion":"3","diasPaHisto":"0","tipoRadicacion":"0","edadReAuto":"0","genNuevoRadicadoEstado":"false","grupo":"0","id":"10321","programaPadre":"1021","indicadorProgramaEstado":"0","indicadorVinculacionEstado":"0","manejaResponsable1PersonaEstado":"false","manejaResponsable2EmpresaEstado":"false","motivoRetiroOpcional":{"id":"1","nombre":"VoluntarioportrasladodeCaja"},"clientePropietarioID":"0","tipoParentesco":"HI","sigla":"CJ","tipoIdClientePropietario":"0","nombrePrograma":"HijosdeTrabajadorDependiente","nombreProgramaPadre":"","diasParaReactivacion":"0"}]},"id":"2811494","motivoInactivacion":{"id":"21"},"estadoAfiliacion":"1","clienteID":""}]},"Radicacion":""},"atributosComunes":{"beneficiarioEstado":"false","empresaEstado":"false","saltarFoneticoEstado":"false","indice":"0","edadMayor":"false"}}}}';
	private static String responseRequisitos = '{ "ConsultaRequisitos_Response" : { "Header" : { "System" : { "RequestDate" : "2017-09-28T09:48:45.723-05:00", "ResponseDate" : "2017-09-28T09:48:46.612-05:00", "ResponseCode" : "0", "ResponseDesc" : "OK", "TransactionID" : "SWPR14020170918162528248" } }, "Body" : { "Requisitos" : { "Requisito" :[{ "Tipo" : "ACSENA", "FechaInicio" : "0", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "400", "ValorBooleano" : "false" },{ "Tipo" : "ACTECO", "FechaInicio" : "0", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "4290", "ValorBooleano" : "false" },{ "Tipo" : "CLINTE", "FechaInicio" : "20170429", "FechaFin" : "0", "ValorAlfanumerico" : "4", "ValorNumerico" : "0", "ValorBooleano" : "false" },{ "Tipo" : "CODARP", "FechaInicio" : "20161019", "FechaFin" : "20161019", "ValorAlfanumerico" : "", "ValorNumerico" : "111", "ValorBooleano" : "false" },{ "Tipo" : "CORELE", "FechaInicio" : "0", "FechaFin" : "0", "ValorAlfanumerico" : "ligcolors9X@Xhotmail5.com", "ValorNumerico" : "0", "ValorBooleano" : "false" },{ "Tipo" : "EMIDIS", "FechaInicio" : "20161019", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "2", "ValorBooleano" : "true" },{ "Tipo" : "FCONST", "FechaInicio" : "20121213", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "20020906", "ValorBooleano" : "false" },{ "Tipo" : "IDREPL", "FechaInicio" : "20110624", "FechaFin" : "0", "ValorAlfanumerico" : " ", "ValorNumerico" : "6271027739086901", "ValorBooleano" : "false" },{ "Tipo" : "INVEST", "FechaInicio" : "20130730", "FechaFin" : "20130730", "ValorAlfanumerico" : "SOLICITUD DE PAULA HERNANDEZ 20130729. RM INFORMAN QUE NO TITIEN NI CONTRATOS NI NÃ“MINAS Y ESTA EN PROCESO D", "ValorNumerico" : "8", "ValorBooleano" : "false" },{ "Tipo" : "PAGAPO", "FechaInicio" : "20170608", "FechaFin" : "20170708", "ValorAlfanumerico" : "201705", "ValorNumerico" : "300000", "ValorBooleano" : "false" },{ "Tipo" : "QBENFA", "FechaInicio" : "20161024", "FechaFin" : "", "ValorAlfanumerico" : "", "ValorNumerico" : "6", "ValorBooleano" : "true" },{ "Tipo" : "REPLEG", "FechaInicio" : "20110628", "FechaFin" : "0", "ValorAlfanumerico" : "DARIO JOSE LINARES AGUDELO", "ValorNumerico" : "5", "ValorBooleano" : "false" },{ "Tipo" : "TELCEL", "FechaInicio" : "0", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "5153171274", "ValorBooleano" : "true" },{ "Tipo" : "TIPEMP", "FechaInicio" : "0", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "2", "ValorBooleano" : "false" },{ "Tipo" : "TAMEMP", "FechaInicio" : "0", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "3", "ValorBooleano" : "false" },{ "Tipo" : "CODARP", "FechaInicio" : "0", "FechaFin" : "0", "ValorAlfanumerico" : "", "ValorNumerico" : "22", "ValorBooleano" : "false" }] } } }}';
	private static void crearDatos(){
		COM_Poblacion__c ciudad = new COM_Poblacion__c();
		ciudad.Name = 'nombre';
		ciudad.COM_Codigo__c = '11001';
		ciudad.COM_Departamento__c = '11';
		insert ciudad;

		Account arl = new Account();
		arl.Name = 'arl';
		arl.COM_TipoIdentificacion__c = '2';
		arl.COM_Numero_de_identificacion__c = '123456789';
		arl.COM_CodigoARL__c = '22';
		arl.COM_EsARL__c = true;
		insert arl;
	}


	@isTest static void consultarClienteEmpresa() {
		crearDatos();
		Test.startTest();
	        COM_CalloutGenericRestMock_tst tstMock = new COM_CalloutGenericRestMock_tst(responseEmpresa, 200, 'OK');
	        COM_CalloutGenericRestMock_tst tstMock2 = new COM_CalloutGenericRestMock_tst(responseRequisitos, 200, 'OK');
	        Test.setMock(HttpCalloutMock.class, tstMock);
	        COM_WrapperConsultaClienteGCResponse_cls.Body response = clsConsultar.Consultar(2, 900017447);		
			COM_ConsultarClienteGC_ws.WrapperClienteResponse wprResponse;
			Test.setMock(HttpCalloutMock.class, tstMock2);
			wprResponse = clsConsultar.mapCamposCuenta(response);
			String idCliente = clsConsultar.CrearCliente(wprResponse);
		Test.stopTest();
	}
	@isTest static void consultarClientePersona() {
		crearDatos();
		Test.startTest();
	        COM_CalloutGenericRestMock_tst tstMock = new COM_CalloutGenericRestMock_tst(responsePersona, 200, 'OK');
	        COM_CalloutGenericRestMock_tst tstMock2 = new COM_CalloutGenericRestMock_tst(responseRequisitos, 200, 'OK');
	        Test.setMock(HttpCalloutMock.class, tstMock);
	        COM_WrapperConsultaClienteGCResponse_cls.Body response = clsConsultar.Consultar(2, 900017447);		
			COM_ConsultarClienteGC_ws.WrapperClienteResponse wprResponse;
			Test.setMock(HttpCalloutMock.class, tstMock2);
			wprResponse = clsConsultar.mapCamposCuenta(response);
			String idCliente = clsConsultar.CrearCliente(wprResponse);
		Test.stopTest();
	}
		
}